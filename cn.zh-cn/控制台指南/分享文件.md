# 分享文件<a name="obs_03_0046"></a>

## 操作场景<a name="section10566111319376"></a>

您可以使用文件分享功能，通过文件的临时URL将存放在OBS中的文件分享给所有用户。

## 背景知识<a name="section11953161812519"></a>

文件分享强调临时性，所有分享的URL都是临时URL，存在有效期。

临时URL是由文件的访问域名和临时鉴权信息组成。示例如下：

```
https://bucketname.obs.cn-north-4.myhuaweicloud.com:443/image.png?AccessKeyId=xxx&Expires=xxx&response-content-disposition=xxx&x-obs-security-token=xxx&Signature=xxx
```

临时鉴权信息主要包含**AccessKeyId**、**Expires**、**x-obs-security-token**和**Signature**四个参数。其中**AccessKeyId**、**x-obs-security-token**和**Signature**用于鉴权，**Expires**定义鉴权的有效期。临时鉴权的方法及各参数的详细解释，请参见《对象存储服务API参考》的[URL中携带签名](https://support.huaweicloud.com/api-obs/obs_04_0011.html)章节。此外，临时URL中还包含了**response-content-disposition**，定义访问对象时是直接下载或者在浏览器中预览，取值由浏览器根据所分享对象的Content-Type解析所得。

当在OBS控制台上单击了对象后的“分享”之后，OBS就会以默认5分钟的有效期获取临时鉴权信息，并生成分享链接，此时链接就已经生效并且开始计算时间了。每调整一次URL有效期，OBS就会重新获取一次鉴权信息以生成新的分享链接，新链接的有效期从调整的时候开始计算。

## 约束与限制<a name="section1524379204718"></a>

-   通过OBS控制台分享的文件，有效期的范围为1分钟到18小时。如果想要设置更长的有效期，建议使用客户端工具OBS Browser+，OBS Browser+支持1分钟到30天的有效期。如果想要设置永久的权限，请通过[桶策略或对象策略](桶策略和对象策略.md)实现。
-   仅桶版本号为3.0的桶支持文件分享功能。桶版本号可以在桶概览页的“基本信息”中查看。
-   加密对象不能分享。
-   归档存储对象需恢复后才能分享。

## 操作步骤<a name="section2745155111154"></a>

1.  在OBS管理控制台左侧导航栏选择“对象存储“。
2.  在桶列表单击待操作的桶，进入“概览”页面。
3.  在左侧导航栏，单击“对象”。
4.  选中待分享的文件，并单击右侧的“分享”，系统弹出如[图1](#fig15421122341817)所示对话框。

    此时，链接信息中的链接就已经生效并开始计时，有效期为默认的5分钟。修改URL有效期，链接会相应变化，新链接的有效期从修改时开始计算。

    **图 1**  分享文件<a name="fig15421122341817"></a>  
    ![](figures/分享文件.png "分享文件")

5.  URL相关操作。

    -   单击“打开URL”，将在新页面打开文件进行预览或者直接下载文件到本地。
    -   单击“复制链接”，您可以将该链接分享给所有用户，用户可以在浏览器中通过此链接直接访问文件。
    -   单击“复制路径”，您可将该路径分享给所有拥有对象所在桶权限的用户，用户可以在对应桶中的文件搜索框中输入该路径搜索并访问文件。

    >![](public_sys-resources/icon-note.gif) **说明：** 
    >在“URL有效期”内，任何用户都可以访问该文件。


